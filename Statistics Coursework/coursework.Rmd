---
title: "Coursework"
author: "William Dennis"
date: "25/03/2021"
output: html_document
---

Question 3
Is the SSRI effective in treating anxiety and depression?

We built effective linear models using the step function

Looking at the summary of the the new models the P values of SSRI are both below 5% and reduce both phq and gad scores 


```{r Question 3}
load('anxdep.rda')
df = na.omit(anxdep)
lmodgad = lm(gadfinal ~ gadinit + phqinit + treatment + sex + age + ethnic + finance + education + empstat + relstatus + depressedinpast, data = df)
lmodphq = lm(phqfinal ~ gadinit + phqinit + treatment + sex + age + ethnic + finance + education + empstat + relstatus + depressedinpast, data = df)
step(lmodgad)
step(lmodphq)
new_lmodgad = lm(gadfinal ~ treatment + depressedinpast + gadinit, data = df)
new_lmodphq = lm(phqfinal ~ relstatus + treatment + ethnic + empstat + finance + phqinit, data = df)
print(summary(new_lmodgad))
print(summary(new_lmodphq))
```


```{r}
library(ggplot2)
load('anxdep.rda')
anxdep$gadchg <- anxdep$gadinit - anxdep$gadfinal
anxdep$phqchg <- anxdep$phqinit - anxdep$phqfinal
ggplot(anxdep, aes(gadchg, phqchg,colour = factor(treatment))) + geom_point() + geom_smooth()
ggplot(anxdep, aes(gadinit, gadfinal,colour = factor(treatment))) + geom_point() + geom_smooth()
ggplot(anxdep, aes(phqinit, phqfinal,colour = factor(treatment))) + geom_point() + geom_smooth()
```
