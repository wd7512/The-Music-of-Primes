!function(){var globalFunctions=gtmDataLayer.get("dLPlatformFuncs")||{},pageLoadSetVarsObj=gtmDataLayer.get("pageLoadSetVars")||{};pageLoadSetVarsObj.confirmationPageAA=function(){var orderProductString,delivCharge,prodMethWeighted,trolleyData,orderNumberPos,orderIdNumber,productCount,delivMethod,payMethod,slotDateTime,slotLeadTime,totalItemsCount,guidePrice,totalPrice,amendTrolley,isAmend,amendProductString,itemsAdded,itemsRemoved,busOrderCounponCount,busOrderCounponDiscount,busOrderCounponType,busOrderCounponCode,discountEventNo,countryCode=globalFunctions.countryAA()||null,storeID=globalFunctions.storeID()||null,orderIDCleaner=null;gtmDataLayer.get("trolleyData")&&(orderIdNumber=(trolleyData=gtmDataLayer.get("trolleyData")).trolleyDataOrderIDNumber||null,productCount=trolleyData.trolleyDataProdCount||null,delivMethod=trolleyData.trolleyDataDelivMethod||null,payMethod=trolleyData.trolleyDataPayMethod||null,slotDateTime=trolleyData.trolleyDataSlotTime||null,slotLeadTime=trolleyData.trolleyDataSlotLeadTime||null,totalItemsCount=trolleyData.trolleyDataTotalItemsCount||null,guidePrice=trolleyData.trolleyDataGuidePrice||null,totalPrice=trolleyData.trolleyDataTotalPrice||null,bagOption=trolleyData.bagOption||null,orderProductString=trolleyData.trolleyDataProductString||null,delivCharge=trolleyData.trolleyDataDelivCharge||null,prodMethWeighted=trolleyData.trolleyDataHasWeightedProduct||null,s.prop1=s.prop4="checkout",s.eVar70=s.prop1,s.eVar73=s.prop4,s.eVar138=productCount,s.eVar69=delivMethod,s.eVar5=payMethod,s.eVar6=slotDateTime,s.eVar59=slotLeadTime,s.eVar193=totalPrice,s.eVar190=bagOption,orderIdNumber&&(orderNumberPos=orderIdNumber.length,-1<orderIdNumber.indexOf("_")&&(orderNumberPos=orderIdNumber.indexOf("_")),orderIDCleaner=storeID+":"+orderIdNumber.substring(0,orderNumberPos)+":"+countryCode,s.eVar10=orderIDCleaner),s.events+=",event89="+productCount),gtmDataLayer.get("amendTrolley")&&(isAmend=(amendTrolley=gtmDataLayer.get("amendTrolley")).amendTrolleyIsAmend||null,amendProductString=amendTrolley.amendTrolleyProductString||null,itemsAdded=amendTrolley.amendTrolleyItemsAdded||null,itemsRemoved=amendTrolley.amendTrolleyItemsRemoved||null),1==isAmend?(_gtm.notify("GTM: confirmation - doing amend"),s.pageName=s.eVar14="checkout:amend confirmation",s.prop2=s.prop3="checkout:amend confirmation",s.eVar71=s.prop2,s.eVar72=s.prop3,gtmDataLayer.get("trolleyData")&&(s.events+=",event58,event146="+guidePrice+",event145="+totalItemsCount),_gtm.localStorage.get("gtm_amd_opd")&&(s.events+=",event143="+_gtm.localStorage.get("gtm_amd_opd"),_gtm.localStorage.remove("gtm_amd_opd")),_gtm.localStorage.get("gtm_amd_ogp")&&(s.events+=",event144="+_gtm.localStorage.get("gtm_amd_ogp"),_gtm.localStorage.remove("gtm_amd_ogp")),"UK"==countryCode&&(s.products=amendProductString,"true"==itemsAdded&&(s.events+=",event49,event50"),"true"==itemsRemoved&&(s.events+=",event51,event52"))):(s.pageName=s.eVar14="checkout:confirmation",s.prop2=s.prop3="checkout:confirmation",s.eVar71=s.prop2,s.eVar72=s.prop3,s.events+=",purchase,event84="+guidePrice+",event126="+delivCharge,1==prodMethWeighted&&(s.linkTrackEvents+="event154",s.events+=",event154"),s.products=orderProductString,orderIDCleaner&&(s.purchaseID=orderIDCleaner),s.eVar137=delivCharge,_gtm.sessionStorage.get("CoupUsed")&&(busOrderCounponCount=_gtm.sessionStorage.get("CoupCount"),busOrderCounponDiscount=_gtm.sessionStorage.get("CoupDisc"),busOrderCounponType=_gtm.sessionStorage.get("CoupType"),busOrderCounponCode=_gtm.sessionStorage.get("CoupCode"),discountEventNo="points"==busOrderCounponType?"event149":"event62",s.eVar68=busOrderCounponCode,s.eVar118=busOrderCounponType,s.events+=",event54,event63="+busOrderCounponCount+","+discountEventNo+"="+busOrderCounponDiscount,_gtm.sessionStorage.remove("CoupUsed"),_gtm.sessionStorage.remove("CoupCount"),_gtm.sessionStorage.remove("CoupDisc"),_gtm.sessionStorage.remove("CoupType"),_gtm.sessionStorage.remove("CoupCode")))},gtmDataLayer.set("pageLoadSetVars",pageLoadSetVarsObj)}();