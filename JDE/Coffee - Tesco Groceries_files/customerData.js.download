bertie.on("customerData",function(e){try{var amendMode=e.flags.amendMode,dsObj=e.flags.deliverySaverCurrent,deliverySaverPlan=!(null==dsObj||!dsObj.hasSubscription)&&dsObj.planDuration+"|"+dsObj.planType+"|"+dsObj.hasFreeSameDayDelivery;custType=e.flags.authenticated;var customerDataObj={busCustomerAuthenticated:custType?"logged in":"anonymous",busCustomerUUID:e.UUID||null,busCustomerHashedEmail:e.hashedEmail||null,busCustomerTrkId:e.trkid||null,busCustomerAmendStart:e.flags.amendStart||null,busAddressID:e.flags.addressId||null,busNumberActiveOrders:null!=e.flags.pendingOrders?e.flags.pendingOrders.length:null,busCustomerFTS:void 0!==e.flags.firstTimeShopper?String(e.flags.firstTimeShopper):null,busCustomerLoyaltyType:void 0!==e.flags.firstTimeShopper&&e.flags.firstTimeShopper?"first-time":"existing",busCustomerSegment:e.flags.segments||null,busCustomerOrderCount:e.flags.orderCount||null,busCustomerOrderId:e.flags.orderID||null,busCustomerBreakpoint:e.flags.device.breakpoint||null,busCustomerSlotPrice:e.flags.bookedSlot.charge.price||null,busCustomerSlotState:e.flags.bookedSlot.state||null,deliverySaverPlan:deliverySaverPlan,busCustomerAmendMode:amendMode?"amend":"normal"},slotStart=e.flags.bookedSlot.start,slotEnd=e.flags.bookedSlot.end,UIStartTimePos=slotStart.indexOf("T",0),UIStartTime=slotStart.substring(UIStartTimePos+1,UIStartTimePos+6),UIEndTimePos=slotEnd.indexOf("T",0),UIEndTime=slotEnd.substring(UIEndTimePos+1,UIEndTimePos+6),slotValue=slotStart.substring(0,10).replace(/-/g,"")+"-"+UIStartTime+"-"+UIEndTime,slotMethod=e.flags.bookedSlot.method,startHour=UIStartTime.substring(0,2),slotDuration=UIEndTime.substring(0,2)-startHour,slotMethodFull=slotMethod+" "+slotDuration+" hour";"--"!=slotValue&&(customerDataObj.busCustomerSlotDateTime=slotValue),0<slotDuration&&(customerDataObj.busCustomerSlotMethod=slotMethodFull);var customerDevice=customerDataObj.busCustomerBreakpoint,deviceType="";switch(customerDevice){case"small":deviceType="phone small";break;case"small-medium":deviceType="phone large";break;case"medium":deviceType="tablet";break;case"large":deviceType="desktop small";break;case"extra-large":deviceType="desktop large";break;default:deviceType=null}customerDataObj.busCustomerDevice=deviceType,dataLayer.push({customerData:customerDataObj})}catch(e){var errorsObj=gtmDataLayer.get("errors")||{};errorsObj.customerData="Unavailable",errorsObj.customerData.eMesssage=e,gtmDataLayer.set("errors",errorsObj)}});