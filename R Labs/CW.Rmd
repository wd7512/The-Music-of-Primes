---
title: "MA20226 Coursework"
author: "William Dennis"
date: "19/11/2020"
output: html_document
---

### Question 1

*Suppose we have an i.i.d. sample of size n = 15 from an unknown continuous distribution. What is the critical region for a size $α=0.05$ test of the hypotheses in Equation (1) with $m_0=0$ based on the test statistic in Equation (2)?*
\

For $m_0$ to be the median, half of the values of x must be above $m_0$ and half below $m_0$. This leads to us being able to describe each value of x as a Bernoulli distribution with a p value of 0.5, where True means it is above x and False means below. Thus from the question we can derive the equation where $m$ is the critial value and we also see that T is binomally distributed.
$$P(T \geq m) \leq 0.05 \quad \textrm{and} \quad T \sim Bin(n = 15,p = \frac{1}{2})$$
and then duduce
$$P(T \geq m) \leq 0.05 \quad = \quad P(T=m) + P(T=m+1)+ \quad ... \quad +P(T=15) \leq 0.05\\$$
$$=\quad\binom{15}{m} \left( \frac{1}{2} \right)^{15} + \binom{15}{m+1} \left( \frac{1}{2} \right)^{15}+\quad ... \quad +\binom{15}{15} \left( \frac{1}{2} \right)^{15}$$

$$=\quad\left( \frac{1}{2} \right)^{15}\left( \binom{15}{m}+\binom{15}{m+1}+\quad...\quad+\binom{15}{15}\right) \leq 0.05$$
To find the critial value m we can use a R Script to find this.
```{r}
m_values = array(0,dim=c(16,2))
for (i in 0:15){
  var = 0
  for (j in i:15){
    var = var + choose(15,j)
  }
  m = var * (1/2)^15
  m_values[i+1,1] = m
  m_values[i+1,2] = (m <= 0.05)
}

colnames(m_values) = c('P-Value of m','Less than 0.05?')
rownames(m_values) = 0:15
print(m_values)
```
As we can see from this table, the critial value $m$ is 12 as it is the smallest value $m$ that falls in the critical region of size 	$\alpha = 0.05$ 

\

### Question 2

*Consider the following two data sets (which differ only in the first and last values)*

```{r}
set_1 = c(-1.4,2.8,3,0.8,1.5,2.2,-2.5,2,1.8,3.5,2.5,0.1,-3.3,3.6,1.4)
set_2 = c(-14,2.8,3,0.8,1.5,2.2,-2.5,2,1.8,3.5,2.5,0.1,-3.3,3.6,14)
```

*Carry out the sign test with $m_0=0$ and the t-test with $μ_0=0$ on each data set using $α=0.05$. Comment on any similarities or differences between the two testing procedures. For this question, you may not use the functions introduced next.*
\

The hypothesis for the sign test is a follows
$$H_0 \ : \ m=m_0 \quad \textrm{versus} \quad H_1 \ : \ m>m_0$$
To accept $H_0$ the number of values greater than $m=0$ must be less than 12 as shown from part 1.
```{r}
var1 = sum(set_1 > 0)
var2 = sum(set_2 > 0)
print(c(var1,var2))

```
As we can see from these results we reject the null hypotheses for data set 1 and data set 2 as they both have 12 values greater than the mean.


The hypotheses for the t-test is as follows

$$H_0 \ : \ μ=μ_0 \quad \textrm{versus} \quad H_1 \ : \ μ>μ_0$$
To carry out this test we reject the null hypotheses if this statement is true
$$ \bar{x} \ \geq \ μ_0 + t_{1-α,n-1} \frac{s}{ \sqrt{n}} \implies \bar{x} \ \geq \ t_{1-α,n-1} \frac{s}{ \sqrt{n}}$$

$$t_{1-α,n-1} \quad = \quad t_{0.95,14} \quad = \quad 1.761$$
We calculate the t values with the following R code
```{r}
mean1 = mean(set_1)
mean2 = mean(set_2)
var1 = 1.761 * var(set_1) / sqrt(length(set_1))
var2 = 1.761 * var(set_2) / sqrt(length(set_2))

print(c(mean1 >= var1,mean2 >= var2))
```
Due to both of these values being FALSE we accept the null hypotheses for data set 1 and data set 2

\

### Question 3









