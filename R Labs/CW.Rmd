---
title: "MA20226 Coursework"
author: "William Dennis"
date: "19/11/2020"
output: html_document
---

### Question 1

*Suppose we have an i.i.d. sample of size n = 15 from an unknown continuous distribution. What is the critical region for a size $α=0.05$ test of the hypotheses in Equation (1) with $m_0=0$ based on the test statistic in Equation (2)?*
\

For $m_0$ to be the median, half of the values of x must be above $m_0$ and half below $m_0$. This leads to us being able to describe each value of x as a Bernoulli distribution with a p value of 0.5, where True means it is above x and False means below. Thus from the question we can derive the equation where $m$ is the critial value and we also see that T is binomally distributed.
$$P(T \geq m) \leq 0.05 \quad \textrm{and} \quad T \sim Bin(n = 15,p = \frac{1}{2})$$
and then duduce
$$P(T \geq m) \leq 0.05 \quad = \quad P(T=m) + P(T=m+1)+ \quad ... \quad +P(T=15) \leq 0.05\\$$
$$=\quad\binom{15}{m} \left( \frac{1}{2} \right)^{15} + \binom{15}{m+1} \left( \frac{1}{2} \right)^{15}+\quad ... \quad +\binom{15}{15} \left( \frac{1}{2} \right)^{15}$$

$$=\quad\left( \frac{1}{2} \right)^{15}\left( \binom{15}{m}+\binom{15}{m+1}+\quad...\quad+\binom{15}{15}\right) \leq 0.05$$
To find the critial value m we can use a R Script to find this.
```{r}
m_values = array(0,dim=c(16,2))
for (i in 0:15){
  var = 0
  for (j in i:15){
    var = var + choose(15,j)
  }
  m = var * (1/2)^15
  m_values[i+1,1] = m
  m_values[i+1,2] = (m <= 0.05)
}

colnames(m_values) = c('P-Value of m','Less than 0.05?')
rownames(m_values) = 0:15
print(m_values)
```
As we can see from this table, the critial value $m$ is 12 as it is the smallest value $m$ that falls in the critical region of size 	$\alpha = 0.05$ 

\

### Question 2

*Consider the following two data sets (which differ only in the first and last values)*

```{r}
set_1 = c(-1.4,2.8,3,0.8,1.5,2.2,-2.5,2,1.8,3.5,2.5,0.1,-3.3,3.6,1.4)
set_2 = c(-14,2.8,3,0.8,1.5,2.2,-2.5,2,1.8,3.5,2.5,0.1,-3.3,3.6,14)
```

*Carry out the sign test with $m_0=0$ and the t-test with $μ_0=0$ on each data set using $α=0.05$. Comment on any similarities or differences between the two testing procedures. For this question, you may not use the functions introduced next.*
\

The hypothesis for the sign test is a follows
$$H_0 \ : \ m=m_0 \quad \textrm{versus} \quad H_1 \ : \ m>m_0$$
To accept $H_0$ the number of values greater than $m=0$ must be less than 12 as shown from part 1.
```{r}
var1 = sum(set_1 > 0)
var2 = sum(set_2 > 0)
print(c(var1,var2))

```
As we can see from these results we reject the null hypotheses for data set 1 and data set 2 as they both have 12 values greater than the mean.


The hypotheses for the t-test is as follows

$$H_0 \ : \ μ=μ_0 \quad \textrm{versus} \quad H_1 \ : \ μ>μ_0$$
To carry out this test we reject the null hypotheses if this statement is true
$$ \bar{x} \ \geq \ μ_0 + t_{1-α,n-1} \frac{s}{ \sqrt{n}} \implies \bar{x} \ \geq \ t_{1-α,n-1} \frac{s}{ \sqrt{n}}$$

$$t_{1-α,n-1} \quad = \quad t_{1-0.05,15-1} \quad = \quad t_{0.95,14} \quad = \quad 1.761$$
We calculate the t values with the following R code
```{r}
mean1 = mean(set_1)
mean2 = mean(set_2)
var1 = 1.761 * sd(set_1) / sqrt(length(set_1))
var2 = 1.761 * sd(set_2) / sqrt(length(set_2))

print(c(mean1 >= var1,mean2 >= var2))

```
We can then see that we reject the null hypotheses for data set 1 and accept the null hypotheses for data set 2.

\

### Question 3

*Perform a simulation study to confirm that the sign test (as coded in the function above) yields a test with the correct significance level using $nSim=10,000$ simulations of samples of size $n=100$ from a $N(μ,1)$ distribution with $α=0.05$.*

```{r}
load(url('http://people.bath.ac.uk/trs35/tests_code.R'))
```


```{r}
set.seed(0)
nSim = 10000
n = 100
arr = array(0,dim=nSim)

for (i in 1:nSim){
  var = rnorm(n,mean = 0,sd = 1)
  arr[i] = sign.test(var)
}
print(sum(arr)/length(arr))
```
We can see that the significance level is less then 0.05 so we can confirm that it yields the correct significant level.

\

### Question 4

*Perform a simulation study to compare the power of the sign test and the t-test using $nSim=1,000$ simulations of samples of size $n=25$ from a $N(μ,1)$ distribution. Plot the power of each test as a function of $μ$ in the interval (0, 2).*

```{r}
set.seed(0)
nSim = 1000
n = 25
mew_arr = seq(0,2,0.05)

arr = array(0,dim=c(2,length(mew_arr)))

for (i in 1:length(mew_arr)){
  
  arr1 = array(0,dim=nSim)
  arr2 = array(0,dim=nSim)
  for (j in 1:nSim){
    var = rnorm(n, mean = mew_arr[i], sd = 1)
    arr1[j] = sign.test(x = var)
    arr2[j] = myt.test(x = var)
    
  arr[1,i] =1 - sum(arr1) / length(arr1)
  arr[2,i] =1 - sum(arr2) / length(arr2)
    
  }
}
plot(mew_arr,1-arr[1,],main = 'Graph of the Power of the Sign Test for N(μ,1)',xlab = 'Values of μ', ylab = 'Power',ylim = c(0,1))
plot(mew_arr,1-arr[2,],main = 'T-Test',xlab = 'Values of μ', ylab = 'Power',ylim = c(0,1))

```

\

### Question 5

*Perform a simulation study to compare the power of the sign test and the t-test using $nSim=1,000$ simulations of samples of size $n=25$ from a Cauchy distribution with location parameter $m$ and scale parameter 1. You will need to consult the help file ?rcauchy. Plot the power of each test as a function of $m$ in the interval (0, 2).*

```{r}
set.seed(0)
nSim = 1000
n = 25
m_arr = seq(0,2,0.05)

arr = array(0,dim=c(2,length(m_arr)))

for (i in 1:length(m_arr)){
  
  arr1 = array(0,dim=nSim)
  arr2 = array(0,dim=nSim)
  for (j in 1:nSim){
    var = rcauchy(n, location = m_arr[i], scale = 1)
    arr1[j] = sign.test(x = var)
    arr2[j] = myt.test(x = var)
    
  arr[1,i] =1 - sum(arr1) / length(arr1)
  arr[2,i] =1 - sum(arr2) / length(arr2)
    
  }
}
plot(m_arr,1-arr[1,],main = 'Sign Test',xlab = 'Values of m', ylab = 'Power',ylim = c(0,1))
plot(m_arr,1-arr[2,],main = 'T-Test',xlab = 'Values of m', ylab = 'Power',ylim = c(0,1))

```

\

### Question 6

*Based on your simulation studies in Question 4 and 5, what conclusions do you draw about the relative merits of the two testing procedures?*

From these